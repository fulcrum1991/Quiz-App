{# Context: #}
{# sp_game : #}
{# quiztask_answers : #}
{# (geerbt) sp_select_answer_id : ID der ausgewählten Antwort #}
{# (game) questions_list: #}
{# (history) avg_correct_percent': avg_correct_percent #}
{# (history) games_count #}
{# (history) quiztask_stats #}

<div id="card-body" class="card shadow-sm p-4 mb-5 bg-white rounded">
    <h2 class="text-center mb-4">{{ sp_game.name }}</h2>

    <!-- Game completion date -->
    <p class="text-muted">Datum: {{ sp_game.completed_at }}</p>

    <!-- Game statistics -->
    <div id="game_stats" class="mb-4">
        <div class="row">
            <div class="col-md-4">
                <p><strong>Fragen richtig beantwortet:</strong> {{ sp_game.correct_percent }} %</p>
            </div>
            <div class="col-md-4">
                <p><strong>Durchschnittlich richtig beantwortete Fragen mit diesem Pool:</strong> {{ avg_correct_percent }} %</p>
            </div>
            <div class="col-md-4">
                <p><strong>Spiele mit diesem Quizpool:</strong> {{ games_count }}</p>
            </div>
        </div>
    </div>

    <!-- Quiz task statistics -->
    <div id="list_quiztasks" class="table-responsive">
        <table class="table table-bordered table-hover">
            <thead class="thead-light">
                <tr>
                    <th scope="col">#</th>
                    <th scope="col">Frage</th>
                    <th scope="col">Deine Antwort</th>
                    <th scope="col">Ergebnis</th>
                    <th scope="col">Richtige Antwort</th>
                    <th scope="col">Wie oft richtig beantwortet</th>
                    <th scope="col">Wie oft falsch beantwortet</th>
                </tr>
            </thead>
            <tbody>
                {% for id, stats in quiztask_stats.items %}
                <tr>
                    <th scope="row">{{ forloop.counter }}</th>
                    <td>{{ stats.question }}</td>
                    <td>{{ stats.selected_answer }}</td>
                    <td>
                        <span class="badge {% if stats.was_correct %} bg-success {% else %} bg-danger {% endif %}">
                            {% if stats.was_correct %} Richtig {% else %} Falsch {% endif %}
                        </span>
                    </td>
                    <td>
                        {% if not stats.was_correct %}
                            {{ stats.right_answer }}
                        {% else %}
                            <span class="text-muted">N/A</span>
                        {% endif %}
                    </td>
                    <td>{{ stats.correct }}</td>
                    <td>{{ stats.wrong }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- Navigation buttons -->
    <div id="game-navigation" class="text-center mt-4">
        <a class="btn btn-outline-primary" href="/singleplayer">Zurück zu Einzelspieler</a>
    </div>
</div>
