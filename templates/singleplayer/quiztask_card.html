{# Context parameters: #}
{# sp_game: The game object. #}
{# quiztask_answers: An object containing the current quiz task and its associated answers. #}
{# selected_answer_id: The id of the currently selected answer.#}
{# result: The result of the current task. #}


<div id="card-body" class="card-body">
    <!-- Result message if available -->
    <div id="result" class="alert alert-info">
        {% if result %}
            {{ result.answer_message }}
        {% endif %}
    </div>

    <!-- Question display -->
    <div id="question" class="mb-4">
        <h5>{{ quiztask_answers.quiztask.question }}</h5>
    </div>

    <!-- List of answers -->
    <div id="answers">
        <table class="table table-bordered table-hover">
            <thead class="thead-light">
                <tr>
                    <th scope="col">Auswahl</th>
                    <th scope="col">Antwort</th>
                    {% if result %}
                        <th scope="col">Erklärung</th>
                    {% endif %}
                </tr>
            </thead>
            <tbody>
                {% for answer in quiztask_answers.answers %}
                    <tr>
                        <!-- Indicates if the answer has been selected -->
                        <td>
                            {% if selected_answer_id == answer.id %}
                                <span class="badge bg-primary">X</span>
                            {% endif %}
                        </td>
                        <!-- Clickable answer -->
                        <td>
                            <span hx-get="{% url 'sp_select_answer' sp_game.id quiztask_answers.quiztask.id answer.id %}" hx-target="#task-card" class="text-decoration-underline text-primary">
                                {{ answer.answer }}
                            </span>
                        </td>
                        <!-- Explanation -->
                        {% if result %}
                            <td>{{ answer.explanation }}</td>
                        {% endif %}
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<!-- Navigation buttons -->
<div id="game-navigation" class="d-flex justify-content-between mt-4">
    <button class="btn btn-outline-secondary" hx-get="{% url 'previous_task' sp_game.id quiztask_answers.quiztask.id %}" hx-target="#task-card">Zurück</button>
    
    {% if selected_answer_id and not sp_game.completed %}
        <button class="btn btn-outline-primary" hx-get="{% url 'evaluate_task' sp_game.id quiztask_answers.quiztask.id selected_answer_id %}" hx-target="#task-card">Auswertung</button>
    {% endif %}
    
    {% if sp_game.completed %}
        <button class="btn btn-outline-success" hx-get="{% url 'game_result' sp_game.id %}" hx-target="#task-card">Spielergebnis anzeigen</button>
    {% endif %}
    
    <button class="btn btn-outline-secondary" hx-get="{% url 'next_task' sp_game.id quiztask_answers.quiztask.id %}" hx-target="#task-card">Weiter</button>
</div>
